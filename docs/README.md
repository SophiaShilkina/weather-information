# weather-information

### [English README](https://github.com/SophiaShilkina/weather-information/blob/master/docs/README.EN.md)

## Описание

HTTP-сервер для предоставления информации по погоде с использованием асинхронного фреймворка. 
Данные получает из open-meteo API: https://open-meteo.com/

## Зависимости

Проект использует следующие библиотеки:

- `fastapi` для создания асинхронного HTTP-сервера;
- `httpx` для выполнения асинхронных HTTP-запросов к API Open Meteo;
- `uvicorn` в качестве ASGI-сервера для запуска приложения;
- `APScheduler` для выполнения периодических задач;
- `pydantic` для валидации данных и создания моделей;
- `SQLAlchemy` для работы с базами данных. 

## Методы

### GET /coordinates

**Описание:**  
Метод принимает координаты и возвращает данные о температуре, скорости ветра и атмосферном
давлении на момент запроса.

**Параметры запроса:**
- `latitude` (float, required): Широта в диапазоне от -90 до 90.
- `longitude` (float, required): Долгота в диапазоне от -180 до 180.

**Возвращаемое значение:**  
Возвращает данные в формате JSON, содержащие информацию о температуре, скорости ветра и 
атмосферном давлении.

**Пример запроса:**  

`curl "http://127.0.0.1:8000/coordinates?latitude=55.7558&longitude=37.6173"`

---

### POST /registration

**Описание:**  
Метод предназначен для регистрации пользователей. Принимает имя пользователя и возвращает 
уникальный идентификатор (ID) нового пользователя. Каждый пользователь может иметь свой 
личный список городов и соответствующие прогнозы погоды.

**Параметры запроса:**
- `username` (string, required): Имя пользователя.

**Возвращаемое значение:**  
Возвращает ответ в формате JSON с ID нового пользователя или с ID уже зарегестрированного 
пользователя с аналогичным `username`.

**Условия использования:**  
Все строковые входные данные, передаваемые в запросе, должны быть на английском языке и 
учитывать регистр символов. Значения должны быть уникальными.

**Пример запроса:**  

`curl -X POST "http://127.0.0.1:8000/registration" -H "Content-Type: application/json" 
-d "{\"username\": \"Examiner\"}"`

---

### POST /cities/{usid}

**Описание:**  
Метод принимает название города и его координаты и добавляет в список городов для которых
отслеживается прогноз погоды для определенного пользователя. Для указанных городов сервер 
хранит прогноз погоды на текущий день и обновляет его каждые 15 минут.

**Параметры пути:**
- `usid` (integer, required): ID пользователя, для которого добавляется город.

**Параметры запроса:**
- `city` (string, required): Название города.
- `latitude` (float, required): Широта в диапазоне от -90 до 90.
- `longitude` (float, required): Долгота в диапазоне от -180 до 180.

**Условия использования:**  
Все строковые входные данные, передаваемые в запросе, должны быть на английском языке и 
учитывать регистр символов.

**Пример запроса:**  

`curl -X POST "http://127.0.0.1:8000/cities/1" -H "Content-Type: application/json" -d 
"{\"city\": \"Moscow\", \"latitude\": 55.4507, \"longitude\": 37.3659}"`

---

### GET /forecast/{usid}

**Описание:**  
Метод возвращает список городов, для которых доступен прогноз погоды для определенного 
пользователя.

**Параметры пути:**
- `usid` (integer, required): ID пользователя, для которого возвращается список городов.

**Возвращаемое значение:**  
Возвращает список, содержащий информацию о городах, для которых доступен 
прогноз погоды пользователю.

**Пример запроса:**  

`curl "http://127.0.0.1:8000/forecast/1"`

---

### GET /currentweather/{usid}

**Описание:**  
Метод принимает название города и время и возвращает для него погоду на текущий день в 
указанное время для определенного пользователя. Есть возможность выбора нужных параметров 
погоды в ответе: температура, влажность, скорость ветра, осадки.

**Параметры пути:**
- `usid` (integer, required): ID пользователя, для которого возвращается погода.

**Параметры запроса:**
- `city` (string, required): Название города.
- `time_w` (string, required): Время в формате HH:MM.
- `temperature` (boolean, optional): Включить температуру в ответ. Передать true для активации.
- `humidity` (boolean, optional): Включить влажность в ответ. Передать true для активации.
- `wind_speed` (boolean, optional): Включить скорость ветра в ответ. Передать true для активации.
- `precipitation` (boolean, optional): Включить информацию об осадках в ответ. Передать true для активации.

**Возвращаемое значение:**  
Возвращает ответ в формате JSON с запрашиваемыми параметрами погоды.

**Условия использования:**  
Все строковые входные данные, передаваемые в запросе, должны быть на английском языке и 
учитывать регистр символов. Ненужным параметрам передавать false не требуется. 

**Пример запроса:**  

`curl "http://127.0.0.1:8000/currentweather/1?city=Moscow&time_w=14:00&temperature=true&humidity=true"`

## Установка и запуск

1. Перейдите в желаемую директорию и склонируйте репозиторий:
   ```bash
   git clone https://github.com/SophiaShilkina/weather-information.git
   ```

2. Установите зависимости:
   ```bash
   pip install -r docs/requirements.txt
   ```

3. Запустите приложение:
   ```bash
   python app.py
   ```
   Сервер будет доступен по адресу: http://127.0.0.1:8000

### Вклад

Если вы хотите внести свой вклад в проект, пожалуйста, создайте ветку
с вашим изменением и откройте pull request.

### Лицензия

Этот проект лицензирован на условиях MIT License. Подробности 
смотрите в LICENSE файле.

### Контакты

Если у вас есть вопросы или предложения о сотрудничестве, вы можете связаться со мной в Телеграм: 
[Sophia](https://t.me/ShilkinaSK).
